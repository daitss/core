%img{ :src => '/fda_logo' }

%h1
  daitss
  = Daitss::VERSION

%h2 Notice
%p
  As of 1/7/2014, the Florida Digital Archive is operating under <a href='https://fclaweb.fcla.edu/content/interim-fda-operations'> an interim procedure</a>. Online submission has been disabled during this time.

%hr

%h2
  = "Welcome #{@user.id}"
  
%form{:action => '/logout', :method => 'POST'}
  %input{:type => 'submit', :value => 'logout'}    

  
- if @is_op
  %hr
  %h2 SIP Total summary
  %table
    %tr
      %th count
      %td= Sip.count
    %tr
      %th files
      %td= (Sip.sum :number_of_datafiles )
    %tr
      %th total size
      %td= sprintf('%.2f', Sip.sum(:size_in_bytes).to_i / (1024*1024)) + " MB"
  %hr
  %h2 AIP Total summary
  %table
    %tr
      %th count
      %td= Aip.count - Aip.all(:datafile_count  => 0).count - Aip.all(:datafile_count  => nil).count
    %tr
      %th files
      %td= Aip.sum :datafile_count
    %tr
      %th total size
      %td= sprintf('%.2f', Copy.sum(:size).to_i / (1024*1024)) + " MB"
      
  - Account.all.each do |act|
    %div
      %h2= "Account: #{act.id} - SIP summary"
      %table
        %tr
          %th count
          %td= act.projects.packages.sips.all.count
        %tr
          %th files
          %td= (act.projects.packages.sips.all.sum :number_of_datafiles)
        %tr
          %th total size
          %td= sprintf('%.2f', act.projects.packages.sips.all.sum(:size_in_bytes).to_i / (1024*1024)) + " MB"
    %div
      %h2= "Account: #{act.id} - AIP summary"    
      %table
        %tr
          %th count
          %td= act.projects.packages.aips.count - act.projects.packages.aips.all(:datafile_count => 0).count - act.projects.packages.aips.all(:datafile_count => nil).count
        %tr
          %th files
          %td= act.projects.packages.aips.all.sum :datafile_count
        %tr
          %th total size
          %td= sprintf('%.2f', act.projects.packages.aips.copys.all.sum(:size).to_i / (1024*1024)) + " MB" 
  
      
- else
  %h2
    = "SIP summary for user: #{@user.id}"
  %table
    %tr
      %th count
      %td= @user.packages.sips.all.count
    %tr
      %th files
      %td= (@user.packages.sips.all.sum :number_of_datafiles)
    %tr
      %th total size
      %td= sprintf('%.2f', @user.packages.sips.all.sum(:size_in_bytes).to_i / (1024*1024)) + " MB"
  %h2
    = "AIP summary for user: #{@user.id}"
  %table
    %tr
      %th count
      %td= @user.packages.aips.count - @user.packages.aips.all(:datafile_count => 0).count - @user.packages.aips.all(:datafile_count => nil).count
    %tr
      %th files
      %td= @user.packages.aips.all.sum :datafile_count
    %tr
      %th total size
      %td= sprintf('%.2f', @user.packages.aips.copys.all.sum(:size).to_i / (1024*1024)) + " MB"
    
